var _createClass=function(){function t(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var sha3_256=window.sha3_256,EventEmitter3=window.EventEmitter3,localforage=window.localforage,async=window.async;console.log("sha3_256:",sha3_256),console.log("EventEmitter3:",EventEmitter3),console.log("localforage:",localforage),console.log("async:",async);var FileTable=function(){function n(){_classCallCheck(this,n),this._files=[],this._chunks={};var t=new EventEmitter3;this.on=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.on.apply(t,n)},this.emit=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.emit.apply(t,n)},console.log(async),console.log(async.queue);var e=async.queue(function(e,n){e(n)});this._queue=e}return _createClass(n,[{key:"bind",value:function(e){var t=this,r=this;$(e).change(function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.queueFile.apply(r,n)})}},{key:"queueFile",value:function(e){var n=this,o=this._queue;console.log(o);var t=e.target.files;console.log(t),Object.keys(t).map(function(e){o.push(n.processFile(t[e]),function(){n.emit("new_file")})})}},{key:"processFile",value:function(e){return function(a){var l=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,i=4194304,c=Math.ceil(e.size/i),s=0,u=sha3_256.create();!function o(t){var e=new FileReader;e.onload=function(e){if(u.update(e.target.result),++s<c)o(t);else{var n=btoa(u.hex()).concat(".",function(e,n){if(n||(n={}),!e)return"";var o=(/[^./\\]*$/.exec(e)||[""])[0];return n.preserveCase?o:o.toLowerCase()}(t.name));console.log(n),a()}},e.onerror=function(){console.log("fileReader error.")};var n=s*i,r=n+i>=t.size?t.size:n+i;e.readAsArrayBuffer(l.call(t,n,r))}(e)}}},{key:"addFile",value:function(){return new Promise(function(e,n){})}},{key:"getFiles",value:function(){return this._files}},{key:"getFileChunk",value:function(e,n){return this._chunks[e][n]}}]),n}();window.FileTable=FileTable;