<!DOCTYPE html>
<html>
<head>
<title>File Table Test</title>
</head>
<body>
<h1>This is a Heading</h1>
<p>This is a paragraph.</p>
<input type="file" id="fileTableSelector" multiple/>

<video id="leftVideo" controls muted></video>

<video id="rightVideo" autoplay controls></video>

<script src="/dist/filetable.deps.js"></script>
<script src="/dist/filetable.min.js"></script>
<script>
  $(document).ready(function () {
    var myFileTable = new FileTable();
    myFileTable.bind('#fileTableSelector');
    myFileTable.on('new_file', console.log);
    window.myFileTable = myFileTable;

    var leftVideo = document.getElementById('leftVideo');
    var rightVideo = document.getElementById('rightVideo');
    var mediaSource = new MediaSource();
    leftVideo.src = window.URL.createObjectURL(mediaSource);

    var sourceBuffer;
    myFileTable.on('bufferStart', function () {
      sourceBuffer = mediaSource.addSourceBuffer('video/webm; codecs="vorbis,vp8"');
    });
    myFileTable.on('bufferAppend', function (buffer) {
      sourceBuffer.appendBuffer(new Uint8Array(buffer));
    });
    myFileTable.on('bufferEnd', function () {
      sourceBuffer.addEventListener('updateend', function() {
        if (!sourceBuffer.updating && mediaSource.readyState === 'open') {
          mediaSource.endOfStream();
        }
      });
    });

  });
</script>
</body>
</html>
